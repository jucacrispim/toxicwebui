builders:

  - name: Python
    platform: python3.11
    plugins:
      - name: python-venv
        pyversion: python3.11
        extra_indexes:
          - https://pypi.poraodojuca.dev

    steps:
      - name: Linter checks
        command: ./scripts/run_linter.sh
        stop_on_fail: true

      - name: Code complexity checks
        command: xenon toxicbuild -b B
        warning_on_fail: true

      - name: Unit tests & coverage
        command: ./scripts/check_coverage.sh

      - name: Setup env
        command: ./scripts/env.sh

      - name: Functional tests
        command: pytest tests/functional
        stop_on_fail: true


  - name: Selenium
    platform: python3.11
    plugins:
      - name: apt-install
        packages:
          - chromium-driver
          - xvfb
          - psmisc

      - name: python-venv
        pyversion: python3.11
        extra_indexes:
          - https://pypi.poraodojuca.dev


    steps:
      - name: Run js unit tests
        command: ./scripts/run_jasmine_tests.sh
